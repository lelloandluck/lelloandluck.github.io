<!DOCTYPE HTML>
<html lang="en">


<head>
    <meta charset="utf-8">
    <meta name="keywords" content="A useful application of Python in Excel, QA, SW Test, Automation Test, QTP, UFT, Python, QC, Test Expert, 软件测试, 软件测试专家, 自动化测试专家, 测试经理, 测试管理, 软件自动化测试">
    <meta name="description" content="">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <meta name="renderer" content="webkit|ie-stand|ie-comp">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="format-detection" content="telephone=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <!-- Global site tag (gtag.js) - Google Analytics -->

<script async src="https://www.googletagmanager.com/gtag/js?id="></script>
<script>
    window.dataLayer = window.dataLayer || [];
    function gtag() {
        dataLayer.push(arguments);
    }

    gtag('js', new Date());
    gtag('config', '');
</script>


    <title>A useful application of Python in Excel | Alan.Yuan</title>
    <link rel="icon" type="image/png" href="/favicon.png">

    <link rel="stylesheet" type="text/css" href="/libs/awesome/css/all.css">
    <link rel="stylesheet" type="text/css" href="/libs/materialize/materialize.min.css">
    <link rel="stylesheet" type="text/css" href="/libs/aos/aos.css">
    <link rel="stylesheet" type="text/css" href="/libs/animate/animate.min.css">
    <link rel="stylesheet" type="text/css" href="/libs/lightGallery/css/lightgallery.min.css">
    <link rel="stylesheet" type="text/css" href="/css/matery.css">
    <link rel="stylesheet" type="text/css" href="/css/my.css">

    <script src="/libs/jquery/jquery.min.js"></script>
    <!--<script src="https://sdk.jinrishici.com/v2/browser/jinrishici.js" charset="utf-8"></script>-->

<meta name="generator" content="Hexo 5.4.0">
<style>.github-emoji { position: relative; display: inline-block; width: 1.2em; min-height: 1.2em; overflow: hidden; vertical-align: top; color: transparent; }  .github-emoji > span { position: relative; z-index: 10; }  .github-emoji img, .github-emoji .fancybox { margin: 0 !important; padding: 0 !important; border: none !important; outline: none !important; text-decoration: none !important; user-select: none !important; cursor: auto !important; }  .github-emoji img { height: 1.2em !important; width: 1.2em !important; position: absolute !important; left: 50% !important; top: 50% !important; transform: translate(-50%, -50%) !important; user-select: none !important; cursor: auto !important; } .github-emoji-fallback { color: inherit; } .github-emoji-fallback img { opacity: 0 !important; }</style>
<link rel="stylesheet" href="/css/prism-tomorrow.css" type="text/css"></head>




<body>
    <header class="navbar-fixed">
    <nav id="headNav" class="bg-color nav-transparent">
        <div id="navContainer" class="nav-wrapper container">
            <div class="brand-logo">
                <a href="/" class="waves-effect waves-light">
                    
                    <img src="/medias/logo.png" class="logo-img" alt="LOGO">
                    
                    <span class="logo-span">Alan.Yuan</span>
                </a>
            </div>
            

<a href="#" data-target="mobile-nav" class="sidenav-trigger button-collapse"><i class="fas fa-bars"></i></a>
<ul class="right nav-menu">
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/" class="waves-effect waves-light">
      
      <i class="fas fa-home" style="zoom: 0.6;"></i>
      
      <span>Index</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/tags" class="waves-effect waves-light">
      
      <i class="fas fa-tags" style="zoom: 0.6;"></i>
      
      <span>Tags</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/categories" class="waves-effect waves-light">
      
      <i class="fas fa-bookmark" style="zoom: 0.6;"></i>
      
      <span>Categories</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/archives" class="waves-effect waves-light">
      
      <i class="fas fa-archive" style="zoom: 0.6;"></i>
      
      <span>Archives</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/about" class="waves-effect waves-light">

      
      <i class="fas fa-user-circle" style="zoom: 0.6;"></i>
      
      <span>About</span>
      <i class="fas fa-chevron-down" aria-hidden="true" style="zoom: 0.6;"></i>
    </a>
    <ul class="sub-nav menus_item_child ">
      
      <li>
        <a href="/medias/Alan_CV_EN_LatestUpdate.pdf">
          
          <i class="fab fa-battle-net" style="margin-top: -20px; zoom: 0.6;"></i>
          
          <span>EN-Know me</span>
        </a>
      </li>
      
      <li>
        <a href="/medias/Alan_CV_CN_LatestUpdate.pdf">
          
          <i class="fab fa-battle-net" style="margin-top: -20px; zoom: 0.6;"></i>
          
          <span>CN-Know me</span>
        </a>
      </li>
      
    </ul>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/contact" class="waves-effect waves-light">
      
      <i class="fas fa-comments" style="zoom: 0.6;"></i>
      
      <span>Contact</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/friends" class="waves-effect waves-light">
      
      <i class="fas fa-address-book" style="zoom: 0.6;"></i>
      
      <span>Friends</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/medias/QRcode.jpg" class="waves-effect waves-light">
      
      <i class="fab fa-weixin" style="zoom: 0.6;"></i>
      
      <span>JoinMe</span>
    </a>
    
  </li>
  
  <li>
    <a href="#searchModal" class="modal-trigger waves-effect waves-light">
      <i id="searchIcon" class="fas fa-search" title="Search" style="zoom: 0.85;"></i>
    </a>
  </li>
</ul>


<div id="mobile-nav" class="side-nav sidenav">

    <div class="mobile-head bg-color">
        
        <img src="/medias/logo.png" class="logo-img circle responsive-img">
        
        <div class="logo-name">Alan.Yuan</div>
        <div class="logo-desc">
            
            Never really desperate, only the lost of the soul.
            
        </div>
    </div>

    

    <ul class="menu-list mobile-menu-list">
        
        <li class="m-nav-item">
	  
		<a href="/" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-home"></i>
			
			Index
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/tags" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-tags"></i>
			
			Tags
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/categories" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-bookmark"></i>
			
			Categories
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/archives" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-archive"></i>
			
			Archives
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="javascript:;">
			
				<i class="fa-fw fas fa-user-circle"></i>
			
			About
			<span class="m-icon"><i class="fas fa-chevron-right"></i></span>
		</a>
            <ul  style="background: #00CC00;" >
              
                <li>

                  <a href="/medias/Alan_CV_EN_LatestUpdate.pdf " style="margin-left:50px">
				  
				   <i class="fa fab fa-battle-net" style="position: absolute;left:28px" ></i>
			      
		          <span>EN-Know me</span>
                  </a>
                </li>
              
                <li>

                  <a href="/medias/Alan_CV_CN_LatestUpdate.pdf " style="margin-left:50px">
				  
				   <i class="fa fab fa-battle-net" style="position: absolute;left:28px" ></i>
			      
		          <span>CN-Know me</span>
                  </a>
                </li>
              
            </ul>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/contact" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-comments"></i>
			
			Contact
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/friends" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-address-book"></i>
			
			Friends
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/medias/QRcode.jpg" class="waves-effect waves-light">
			
			    <i class="fa-fw fab fa-weixin"></i>
			
			JoinMe
		</a>
          
        </li>
        
        
    </ul>
</div>


        </div>

        
    </nav>

</header>

    



<div class="bg-cover pd-header post-cover" style="background-image: url('/medias/featureimages/4.jpg')">
    <div class="container" style="right: 0px;left: 0px;">
        <div class="row">
            <div class="col s12 m12 l12">
                <div class="brand">
                    <h1 class="description center-align post-title">A useful application of Python in Excel</h1>
                </div>
            </div>
        </div>
    </div>
</div>




<main class="post-container content">

    
    <link rel="stylesheet" href="/libs/tocbot/tocbot.css">
<style>
    #articleContent h1::before,
    #articleContent h2::before,
    #articleContent h3::before,
    #articleContent h4::before,
    #articleContent h5::before,
    #articleContent h6::before {
        display: block;
        content: " ";
        height: 100px;
        margin-top: -100px;
        visibility: hidden;
    }

    #articleContent :focus {
        outline: none;
    }

    .toc-fixed {
        position: fixed;
        top: 64px;
    }

    .toc-widget {
        width: 345px;
        padding-left: 20px;
    }

    .toc-widget .toc-title {
        padding: 35px 0 15px 17px;
        font-size: 1.5rem;
        font-weight: bold;
        line-height: 1.5rem;
    }

    .toc-widget ol {
        padding: 0;
        list-style: none;
    }

    #toc-content {
        padding-bottom: 30px;
        overflow: auto;
    }

    #toc-content ol {
        padding-left: 10px;
    }

    #toc-content ol li {
        padding-left: 10px;
    }

    #toc-content .toc-link:hover {
        color: #42b983;
        font-weight: 700;
        text-decoration: underline;
    }

    #toc-content .toc-link::before {
        background-color: transparent;
        max-height: 25px;

        position: absolute;
        right: 23.5vw;
        display: block;
    }

    #toc-content .is-active-link {
        color: #42b983;
    }

    #floating-toc-btn {
        position: fixed;
        right: 15px;
        bottom: 76px;
        padding-top: 15px;
        margin-bottom: 0;
        z-index: 998;
    }

    #floating-toc-btn .btn-floating {
        width: 48px;
        height: 48px;
    }

    #floating-toc-btn .btn-floating i {
        line-height: 48px;
        font-size: 1.4rem;
    }
</style>
<div class="row">
    <div id="main-content" class="col s12 m12 l9">
        <!-- 文章内容详情 -->
<div id="artDetail">
    <div class="card">
        <div class="card-content article-info">
            <div class="row tag-cate">
                <div class="col s7">
                    
                    <div class="article-tag">
                        
                            <a href="/tags/Python/">
                                <span class="chip bg-color">Python</span>
                            </a>
                        
                            <a href="/tags/Excel/">
                                <span class="chip bg-color">Excel</span>
                            </a>
                        
                    </div>
                    
                </div>
                <div class="col s5 right-align">
                    
                    <div class="post-cate">
                        <i class="fas fa-bookmark fa-fw icon-category"></i>
                        
                            <a href="/categories/Python/" class="post-category">
                                Python
                            </a>
                        
                            <a href="/categories/Python/Excel/" class="post-category">
                                Excel
                            </a>
                        
                    </div>
                    
                </div>
            </div>

            <div class="post-info">
                
                <div class="post-date info-break-policy">
                    <i class="far fa-calendar-minus fa-fw"></i>Publish Date:&nbsp;&nbsp;
                    2021-12-29
                </div>
                

                
                <div class="post-date info-break-policy">
                    <i class="far fa-calendar-check fa-fw"></i>Update Date:&nbsp;&nbsp;
                    2021-12-29
                </div>
                

                

                

                
            </div>
        </div>
        <hr class="clearfix">

        
        <!-- 是否加载使用自带的 prismjs. -->
        <link rel="stylesheet" href="/libs/prism/prism.css">
        

        
        <!-- 代码块折行 -->
        <style type="text/css">
            code[class*="language-"], pre[class*="language-"] { white-space: pre-wrap !important; }
        </style>
        

        <div class="card-content article-card-content">
            <div id="articleContent">
                <p>How does the python deal with excel in our jobs? i think this is the common issue which asked by people in most. today i will state you what i did on this side. and hopefully this would really help you to accelerate your work effectivity.</p>
<p>Here I wrote serveral functions to deal with excel operations which we use more in daily routine. and the common operations include -<br><font color="purple"></font></p><font color="purple">
<ul>
<li><strong>Create an excel workbook</strong></li>
</ul>
<ul>
<li><strong>Create excel worksheet</strong></li>
<li><strong>Read excel data</strong></li>
</ul>
</font><ul><font color="purple">
<li><strong>Write data into excel spreadsheet</strong></li>
</font><li><font color="purple"><strong>Format excel spreadsheet</strong></font></li>
</ul>
<p>and now, let’s see how I implement all of these Operations</p>
<pre class="line-numbers language-none"><code class="language-none">import win32com
from win32com.client import Dispatch, constants, DispatchEx
import win32com.client, random
import os, sys, time, datetime

class VFQA_ATFW: # equal VFQA_ATFW() or VFQA_ATFW(object)
    """This is the automation test framework we defined for VFQA automation testing, in this framework we defined a sequence on how to develop a script, as well as a test report on how to generate automatically
        please import this package before using this class
        and recall the functions of this class sequentially
    """
    def getBaseScriptParam_A(self, projectName):
        """this function will get the base parames which will offer the params for scripts to set up test report and so on
            1. getRootPath - the path to save test report folder
            2. getCurrentDate - get the time-stamp for time calculate
            3. scriptName - get your current scripts name
            4. projectName - your current project name
        """
        reInitialTime = datetime.datetime.now()
        os.system('taskkill /fi "imagename eq exce*" /f') # kill down all the active excel process

        # 1. Create Test Report Saved Path - Note: this script should be in the same path of split folder 'AlanStudio_2020VF'
        getRootPath = os.path.abspath(".").split('scripts')[0] # get current script absolute path
        print("Debug only - check the scripts path &gt;&gt;&gt; ", getRootPath)
        getCurrentDate = time.strftime("%Y-%m-%d", time.localtime()) # get current system time
        print("Debug only - check the Current Date &gt;&gt;&gt; ", getCurrentDate)
        # scriptName = os.path.basename(__file__).split('.')[0] # get script's Name without suffix
        # print("Debug only - check the Script Name &gt;&gt;&gt; ", scriptName)
        # projectName = "CLM APAC"
        return reInitialTime, getRootPath, getCurrentDate
    # recall sample -
    # projectName = "xxxxxx"
    # reInitialTime, getRootPath, getCurrentDate, scriptName = getBaseScriptParam_A(projectName)

    def creatReport_B(self, getRootPath, getCurrentDate, scriptName):
        # 2. Judge and create a new report path
        newPath = os.path.join(getRootPath, "Automation_Reports", getCurrentDate)
        if os.path.exists(newPath):
            print("The root of Test Report is existing already!")
        else:
            os.makedirs(newPath)
        print(newPath)
        # 3. Create an excel file and record checkpoints for current script as a report -
        reportFile = os.path.join(newPath, scriptName + "_Reports" + ".xlsx")
        return reportFile
    # reportFile = creatReport_B(getRootPath, getCurrentDate)

    def initializeReport_C(self, reportFile):
        """初始化测试报告，如果存在就打开，不存在就创建！"""
        print("Check the test report and see if it's existing, if not just create it.")
        xlApp = win32com.client.Dispatch("Excel.Application")
        if os.path.exists(reportFile):
            print("This report is already existing, just open it!")
            xlOpenBook = xlApp.Workbooks.Open(reportFile)
            sheetCount = xlOpenBook.Worksheets.Count
            addedSheetName = "Runtime_" + str(sheetCount + 1)
            xlOpenBook.Worksheets.Add().Name = addedSheetName
            headerList = ['No', 'Checkpoints', 'Expected Result', 'Actual Result', 'Execuation Status', 'Screen Shot', 'Other/Remark']
            for i in range(0, len(headerList)):
                xlOpenBook.Worksheets(addedSheetName).Cells(1, i+1).value = headerList[i]
            xlOpenBook.Save()
            xlApp.Quit() # Quit excel object so that you can operate it no limited in read-only model
        else:
            xlBook = xlApp.Workbooks.Add() # means new create a excel workbook
            xlBook.Worksheets[0].name = "Runtime_1"
            headerList = ['No', 'Checkpoints', 'Expected Result', 'Actual Result', 'Execuation Status', 'Screen Shot',
                          'Other/Remark']
            for i in range(0, len(headerList)):
                xlBook.Worksheets[0].Cells(1, i+1).value = headerList[i]
            xlBook.SaveAs(reportFile)
            xlApp.Quit()
     # initializeReport_C(reportFile=None)

    def byPassed_D(self, reportFile, checkPointStatement):
        xlApp = Dispatch("Excel.Application")
        xlOpenBook = xlApp.Workbooks.Open(reportFile)
        sheetCount = xlOpenBook.Worksheets.Count
        objSheetName = "Runtime_" + str(sheetCount)
        rowCount = xlOpenBook.Worksheets(objSheetName).UsedRange.Rows.Count # this is the same

        objSheet = xlOpenBook.Worksheets(objSheetName)
        objSheet.Cells(rowCount + 1, 1).Value = rowCount # the title occupied a line already. so here use rowCount not rowCount + 1
        objSheet.Cells(rowCount + 1, 2).Value = checkPointStatement
        index = random.randint(0,7)
        getExpectedVal = ['It\'s supposed to be working as well as the checkpoint said', 'It works as the checkpoint state', 'It works as same as the Checkpoint statement', 'The response should be same as the checkpoint state', '正向执行结果和Checkpoint描述一致。', '和Checkpoint描述一样，能正常执行。', '如Checkpoint描述的一样，能正确获取期望的结果！', '能得到和Checkpoint一样所期待的结果！']
        objSheet.Cells(rowCount + 1, 3).Value = getExpectedVal[index]
        index = random.randint(0, 8)
        getActualVal = ["Great...! It works as expected", "Bingo! it works as same as expected", "正确! 能看到期望的结果", "Excellent! The acutal result is just as same as the expectation", "返回的结果正如Checkpoint所期待的一样", "Great! It indeed got the right return", "正确！检查结果和Checkpoint期待的一致。", "Good! Get the right checkpoint exactly. ", "通过！检查的结果符合预期。"]
        objSheet.Cells(rowCount + 1, 4).Value = getActualVal[index]
        objSheet.Cells(rowCount + 1, 5).Value = "PASS"
        objSheet.Cells(rowCount + 1, 6).Value = "None"
        objSheet.Cells(rowCount + 1, 7).Value = "Nothing for now"
        xlOpenBook.Save() # note the difference between Save and Save()
        xlApp.Quit() # if use xlOpenBook.Quit() the hints will pops up for confirmation
    # checkPointStatement = "Checkpoint01 - Checking the XXXX action and see if it can enter XXX page"
    # byPassed_D(reportFile, checkPointStatement)

    def byFailed_E(self, reportFile, checkPointStatement):
        xlApp = Dispatch("Excel.Application")
        xlOpenBook = xlApp.Workbooks.Open(reportFile)
        sheetCount = xlOpenBook.Worksheets.Count
        objSheetName = "Runtime_" + str(sheetCount)
        rowCount = xlOpenBook.Worksheets(objSheetName).UsedRange.Rows.Count # this is the same

        objSheet = xlOpenBook.Worksheets(objSheetName)
        objSheet.Cells(rowCount + 1, 1).Value = rowCount # the title occupied a line already. so here use rowCount not rowCount + 1
        objSheet.Cells(rowCount + 1, 2).Value = checkPointStatement
        index = random.randint(0, 7)
        getExpectedVal = ['It\'s supposed to be working as well as the checkpoint said', 'It works as the checkpoint state', 'It works as same as the Checkpoint statement', 'The response should be same as the checkpoint state', '正向执行结果和Checkpoint描述一致。', '和Checkpoint描述一样，能正常执行。', '如Checkpoint描述的一样，能正确获取期望的结果！', '能得到和Checkpoint一样所期待的结果！']
        objSheet.Cells(rowCount + 1, 3).Value = getExpectedVal[index]
        index = random.randint(0, 8)
        getActualVal = ["Oh, my god...! It doesn't work as expected as statement", "Unfortunately! it doesn't work as the expected", "抱歉！没有得到期望的结果", "遗憾。。。没有获取期待的结果", "哦偶 :-(! 获取的结果并非Checkpoint所预期的那样。", "不好意思，没有看到预期的结果，请再次确认！", "Oops！What the return result didn't match the expectation. please double check it afterwards.", "Sorry! I didn't see what the checkpoint expected", "It's wrong. The actual result didn't match what you want."]
        objSheet.Cells(rowCount + 1, 4).Value = getActualVal[index]
        objSheet.Cells(rowCount + 1, 5).Value = "FAIL"
        objSheet.Cells(rowCount + 1, 6).Value = "Check in manual again"
        objSheet.Cells(rowCount + 1, 7).Value = "Nothing for now"
        xlOpenBook.Save() # note the difference between Save and Save()
        xlApp.Quit() # if use xlOpenBook.Quit() the hints will pops up for confirmation
    # checkPointStatement = "Checkpoint01 - Checking the XXXX action and see if it can enter XXX page"
    # byFailed_E(reportFile, checkPointStatement)

    def formatReport_F(self, reportFile, scriptAuthor, reInitialTime, projectName, scriptName, testingPurpose):
        if os.path.exists(reportFile):
            # Step One - Create Excel.Application Object and Open an existing file and enter the specified sheet
            xlApp = Dispatch("Excel.Application")
            xlOpenWorkBook = xlApp.Workbooks.Open(reportFile)
            sheetCount = xlOpenWorkBook.Worksheets.Count
            objSheetName = "Runtime_" + str(sheetCount)  # 获得sheet name 主要是为了从sheet名称上来打开指定的sheet，当然也可以用sheets[0]来表示，因为在脚本中创建的sheet都是位于第一个sheet的位置
            xlOpenSheet = xlOpenWorkBook.Worksheets(objSheetName)

            #Step Two - format the repor items - title
            xlOpenSheet.UsedRange.Font.Name = "Gill Sans MT"
            xlOpenSheet.UsedRange.Font.Size = 10
            xlOpenSheet.UsedRange.Rows(1).Font.Size = 12 # Rows(1) 和 Row[1] 表示的意义不一样，前者代表第一行，后者表示第二行。这就是下标使用的作用
            xlOpenSheet.UsedRange.Rows(1).Font.Bold = True # Notice this expression and it's equal the usage below in Bold and Italic
            xlOpenSheet.UsedRange.Rows(1).Interior.ColorIndex = 42

            # Add border and add insert a line spacing, &gt;&gt;&gt; This is the second line#
            xlOpenSheet.UsedRange.Borders.LineStyle = 1
            # xlOpenSheet.UsedRange.Rows(1).Borders.LineStyle = -4119
            xlOpenSheet.Rows[0].Insert() # insert a row at the first row place
            xlOpenSheet.Rows[0].RowHeight = 5 # 设置行高; ColumnWidth 用于设置列宽

            # &gt;&gt;&gt;This is the first line#
            xlOpenSheet.Rows[0].Insert()
            xlOpenSheet.Rows[0].RowHeight = 38
            xlOpenSheet.Range("A1:G1").Borders(4).LineStyle = 1 # solid line or dotted line
            xlOpenSheet.Range("A1:G1").Borders(4).Weight = 3 # may be 4, 3, 1 not others

            xlOpenSheet.Range("A1:G1").Merge() # merge cells for report title text
            xlOpenSheet.Cells(1, 1).Value = "Execution Result for Scripts - " + scriptName # define the report title
            # xlOpenSheet.Range("A1").Font.ColorIndex = 5 # or 41 for setting  blue and light blue value
            xlOpenSheet.Cells(1, 1).Font.Name = "Gill Sans MT"; xlOpenSheet.Cells(1, 1).Font.Size = 15; xlOpenSheet.Cells(1, 1).Font.Bold = True

            # Format Result Color and make the failure record highlighted by Red font and then statistic the checkpoints result
            rowsCount = xlOpenSheet.UsedRange.Rows.Count; passQty = 0; failQty = 0

            for i in range(4, rowsCount + 1):
                if "PASS" == xlOpenSheet.Cells(i, "E").value.upper(): # Notice here - .value is quite equal .Value
                    passQty += 1
                    xlOpenSheet.UsedRange.Cells(i, "E").Font.ColorIndex = 6 # set for font color param
                    xlOpenSheet.UsedRange.Cells(i, "E").Interior.ColorIndex = 10
                else:
                    print("&gt;&gt;&gt; A failure checkpoint found")
                    xlOpenSheet.UsedRange.Rows(i).Font.ColorIndex = 46 ; xlOpenSheet.UsedRange.Rows(i).Font.FontStyle = "Italic"; xlOpenSheet.UsedRange.Rows(i).Font.Bold = True  # ColorIndex value can refer to the "https://zhidao.baidu.com/question/90240687.html".
                    xlOpenSheet.UsedRange.Cells(i, "E").Font.ColorIndex = 6 # set font to red
                    # xlOpenSheet.UsedRange.Rows(i).Interior.ColorIndex = 3 #  set the selected block back graound color to red
                    xlOpenSheet.UsedRange.Cells(i, "E").Interior.ColorIndex = 3 # set the cell back ground color not for Font color
                    failQty += 1

            # Add test Statistic key words, add statistic Title statement -
            xlOpenSheet.Rows(3).Insert() # 在第三行向上插入一行，是以第二行的行高来定义的
            xlOpenSheet.Rows(3).RowHeight = 23
            xlOpenSheet.Cells(3, 1).Value = "Key Information which picked up based on this running -"
            xlOpenSheet.Cells(3, 1).Font.Name = "Gill Sans MT"; xlOpenSheet.Cells(3, 1).Font.Size = 11; xlOpenSheet.Cells(3, 1).Font.Bold = True; xlOpenSheet.Cells(3, 1).Font.ColorIndex = 32; xlOpenSheet.Cells(3, 1).Font.FontStyle = "Bold Italic"
            # xlOpenSheet.Range("A3:C3").Borders(4).LineStyle = 1  # solid line or dotted line xlLineStyleNone -4142 无线条。
            # xlOpenSheet.Range("A1:G1").Borders(4).Weight = 3  # may be 4, 3, 1 not others

            # Add test statistic key words, add the key words
            xlOpenSheet.Rows(4).Insert() #在第四行插入一行，以第三行的行高来定义的
            xlOpenSheet.Rows(4).RowHeight = 15 #设定第四行的行高
            xlOpenSheet.Rows(5).Insert()
            xlOpenSheet.Rows(6).Insert()
            xlOpenSheet.Rows(7).Insert()
            xlOpenSheet.Rows(8).Insert()
            xlOpenSheet.Rows(9).Insert()
            # the line spacing between keywords and checkpoints
            xlOpenSheet.Rows(10).Insert()
            xlOpenSheet.Rows(11).Insert()
            xlOpenSheet.Rows(11).RowHeight = 7

            # Calculate script execution duration
            currentTime = datetime.datetime.now();
            differ = (currentTime - reInitialTime).seconds;
            h = differ // 3600; m = (differ % 3600) // 60; s = (differ % 3600) % 60  # the calculation difference between operate / and //, they would get the same value when the calculate under the all intgers, or difference
            durationTime = str(h) + ' : ' + str(m) + ' : ' + str(s)

            # xlOpenSheet.Range("A1:G1").Borders(4).Weight = 3  # may be 4, 3, 1 not others
            xlOpenSheet.Range("A3:G3").Merge()
            xlOpenSheet.Range("A4:C4").Merge()
            xlOpenSheet.Range("A5:C5").Merge()
            xlOpenSheet.Range("A6:C6").Merge()
            xlOpenSheet.Range("A7:C7").Merge()
            xlOpenSheet.Range("A8:C8").Merge()
            xlOpenSheet.Range("A9:C9").Merge()
            xlOpenSheet.Range("A10:D10").Merge()
            xlOpenSheet.Range("E4:G10").Merge()

            # xlOpenSheet.Range("A3:C3").Borders(4).LineStyle = 1
            xlOpenSheet.Cells(4, "A").Value = " Project Name: " + projectName   # 此处Cells（3，“A”）的写法，行以数字，列以字母标识
            xlOpenSheet.Cells(5, "A").Value = " Script Name: " + scriptName
            xlOpenSheet.Cells(6, "A").Value = " Duration (Hr:Min:Sec) - " + durationTime
            xlOpenSheet.Cells(7, "A").Value = " Passed Checkpoints: " + str(passQty) + "  ; Failed Checkpoints: " + str(failQty)
            xlOpenSheet.Cells(8, "A").Value = " Automated Architecture Module: Automation Framework - VFQA"
            xlOpenSheet.Cells(9, "A").Value = " Script Executor/Designer: " + scriptAuthor
            xlOpenSheet.Cells(10, "A").Value = " Purpose of this script: " + testingPurpose

            xlOpenSheet.UsedRange.Rows(4).Font.Name = "Gill Sans MT";
            xlOpenSheet.UsedRange.Range("A4:G10").Font.Bold = False
            xlOpenSheet.Range("A4:G10").Font.ColorIndex = 56
            xlOpenSheet.Range("A4").GetCharacters(2, 14).Font.Bold = True  # Notice - this sentense is aim to bold the part string by python method
            xlOpenSheet.Range("A5").GetCharacters(2, 13).Font.Bold = True
            xlOpenSheet.Range("A6").GetCharacters(2, 24).Font.Bold = True
            xlOpenSheet.Range("A7").GetCharacters(2, 20).Font.Bold = True
            xlOpenSheet.Range("A7").GetCharacters(27, 44).Font.Bold = True
            xlOpenSheet.Range("A8").GetCharacters(2, 31).Font.Bold = True
            xlOpenSheet.Range("A9").GetCharacters(2, 26).Font.Bold = True
            xlOpenSheet.Range("A10").GetCharacters(2, 24).Font.Bold = True
            xlOpenSheet.UsedRange.Range("A4:G10").Font.Size = 10;  # xlOpenSheet.Range("B" + str(rowsCount + 4) + ":H" +  str(rowsCount + 12)).Font.FontStyle = "Italic";

            # How to implement AutoFit?
            # xlOpenSheet.UsedRange.Columns.AutoFit()
            xlOpenSheet.UsedRange.EntireColumn.AutoFit()
            xlOpenSheet.UsedRange.HorizontalAlignment = 2 # maybe these value - Alignment, 1=auto | Alignment, 2=left | Alignment, 3=centre |Alignment, 4=right | |
            xlOpenSheet.UsedRange.VerticalAlignment = 2 # may be these initialization - Alignment, 1=top | Alignment, 2=middle | Alignment, 3=bottom |

            # Set report tileName alignment and make it align on bottom
            xlOpenSheet.UsedRange.Rows(1).VerticalAlignment = 3
            # Set report subTileName alignment and make it align on bottom
            xlOpenSheet.UsedRange.Rows(3).VerticalAlignment = 3

            # 增加最左边一列，以利排版美观
            xlOpenSheet.Range("A:A").Insert() # Notice - this expression is actually equal with aove one on Insert()
            xlOpenSheet.Range("A1:A" + str(rowsCount + 11)).Borders(2).LineStyle = 1; xlOpenSheet.Range("A1:A" + str(rowsCount + 12)).Borders(2).Weight = 4 # 格式化首列的最右边的实线边框
            # xlOpenSheet.Cells(1, 1).Border(3).LineStyle = 1; xlOpenSheet.Cells(1, 1).Borders(3).Weight = 4; xlOpenSheet.Columns(1).ColumnWidth = 12 # Cells对象后面没有Borders属性，只能用Range来调用Border属性
            xlOpenSheet.Range("A1").Borders(4).LineStyle = 1; xlOpenSheet.Range("A1:A1").Borders(4).Weight = 3; xlOpenSheet.Columns("A").ColumnWidth = 4 # 格式化单元格A1的宽度和下划线, 注意这里Range("A1")不能写成Cells("A1"), Cells参数为2，否则报错

            # 去掉视图的网格线以及标题栏和标尺等属性
            xlApp.ActiveWindow.DisplayGridlines = False
            xlApp.ActiveWindow.DisplayHeadings = False
            xlApp.ActiveWindow.DisplayFormulas = False
            xlApp.ActiveWindow.DisplayWhitespace = False
            xlApp.ActiveWindow.DisplayRuler = False

            # rowCount = xlOpenWorkBook.Worksheets(objSheetName).UsedRange.Rows.Count
            xlOpenWorkBook.Save()

            print("So far, there are", xlOpenSheet.UsedRange.Rows.Count, "rows are available") # comma 连接的是任何数据类型，并且会自动加空格；plus连接的是同类型数据，不会自动加空格，这既是，和 + 连接符的区别
            print("So far, there are", xlOpenSheet.UsedRange.Columns.Count, "Columns are available")
            xlApp.Quit()
        # formatReport_F(reportFile, scriptAuthor, reInitialTime, scriptName)
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

                
            </div>
            <hr/>

            

    <div class="reprint" id="reprint-statement">
        
            <div class="reprint__author">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-user">
                        Author:
                    </i>
                </span>
                <span class="reprint-info">
                    <a href="/about" rel="external nofollow noreferrer">Alan_Yuan</a>
                </span>
            </div>
            <div class="reprint__type">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-link">
                        Link:
                    </i>
                </span>
                <span class="reprint-info">
                    <a href="http://lelloandluck.github.io/2021/12/29/a-useful-application-of-python-in-excel/">http://lelloandluck.github.io/2021/12/29/a-useful-application-of-python-in-excel/</a>
                </span>
            </div>
            <div class="reprint__notice">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-copyright">
                        Reprint policy:
                    </i>
                </span>
                <span class="reprint-info">
                    All articles in this blog are used except for special statements
                    <a href="https://creativecommons.org/licenses/by/4.0/deed.zh" rel="external nofollow noreferrer" target="_blank">CC BY 4.0</a>
                    reprint policy. If reproduced, please indicate source
                    <a href="/about" target="_blank">Alan_Yuan</a>
                    !
                </span>
            </div>
        
    </div>

    <script async defer>
      document.addEventListener("copy", function (e) {
        let toastHTML = '<span>Copied successfully, please follow the reprint policy of this article</span><button class="btn-flat toast-action" onclick="navToReprintStatement()" style="font-size: smaller">more</a>';
        M.toast({html: toastHTML})
      });

      function navToReprintStatement() {
        $("html, body").animate({scrollTop: $("#reprint-statement").offset().top - 80}, 800);
      }
    </script>



            <div class="tag_share" style="display: block;">
                <div class="post-meta__tag-list" style="display: inline-block;">
                    
                        <div class="article-tag">
                            
                                <a href="/tags/Python/">
                                    <span class="chip bg-color">Python</span>
                                </a>
                            
                                <a href="/tags/Excel/">
                                    <span class="chip bg-color">Excel</span>
                                </a>
                            
                        </div>
                    
                </div>
                <div class="post_share" style="zoom: 80%; width: fit-content; display: inline-block; float: right; margin: -0.15rem 0;">
                    <link rel="stylesheet" type="text/css" href="/libs/share/css/share.min.css">
<div id="article-share">

    

    

</div>

                </div>
            </div>
            
                <style>
    #reward {
        margin: 40px 0;
        text-align: center;
    }

    #reward .reward-link {
        font-size: 1.4rem;
        line-height: 38px;
    }

    #reward .btn-floating:hover {
        box-shadow: 0 6px 12px rgba(0, 0, 0, 0.2), 0 5px 15px rgba(0, 0, 0, 0.2);
    }

    #rewardModal {
        width: 320px;
        height: 350px;
    }

    #rewardModal .reward-title {
        margin: 15px auto;
        padding-bottom: 5px;
    }

    #rewardModal .modal-content {
        padding: 10px;
    }

    #rewardModal .close {
        position: absolute;
        right: 15px;
        top: 15px;
        color: rgba(0, 0, 0, 0.5);
        font-size: 1.3rem;
        line-height: 20px;
        cursor: pointer;
    }

    #rewardModal .close:hover {
        color: #ef5350;
        transform: scale(1.3);
        -moz-transform:scale(1.3);
        -webkit-transform:scale(1.3);
        -o-transform:scale(1.3);
    }

    #rewardModal .reward-tabs {
        margin: 0 auto;
        width: 210px;
    }

    .reward-tabs .tabs {
        height: 38px;
        margin: 10px auto;
        padding-left: 0;
    }

    .reward-content ul {
        padding-left: 0 !important;
    }

    .reward-tabs .tabs .tab {
        height: 38px;
        line-height: 38px;
    }

    .reward-tabs .tab a {
        color: #fff;
        background-color: #ccc;
    }

    .reward-tabs .tab a:hover {
        background-color: #ccc;
        color: #fff;
    }

    .reward-tabs .wechat-tab .active {
        color: #fff !important;
        background-color: #22AB38 !important;
    }

    .reward-tabs .alipay-tab .active {
        color: #fff !important;
        background-color: #019FE8 !important;
    }

    .reward-tabs .reward-img {
        width: 210px;
        height: 210px;
    }
</style>

<div id="reward">
    <a href="#rewardModal" class="reward-link modal-trigger btn-floating btn-medium waves-effect waves-light red">赏</a>

    <!-- Modal Structure -->
    <div id="rewardModal" class="modal">
        <div class="modal-content">
            <a class="close modal-close"><i class="fas fa-times"></i></a>
            <h4 class="reward-title">你的赞赏是我前进的动力</h4>
            <div class="reward-content">
                <div class="reward-tabs">
                    <ul class="tabs row">
                        <li class="tab col s6 alipay-tab waves-effect waves-light"><a href="#alipay">支付宝</a></li>
                        <li class="tab col s6 wechat-tab waves-effect waves-light"><a href="#wechat">微 信</a></li>
                    </ul>
                    <div id="alipay">
                        <img src="/medias/reward/alipay.jpg" class="reward-img" alt="支付宝打赏二维码">
                    </div>
                    <div id="wechat">
                        <img src="/medias/reward/wechat.png" class="reward-img" alt="微信打赏二维码">
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
    $(function () {
        $('.tabs').tabs();
    });
</script>

            
        </div>
    </div>

    

    

    

    

    

    

    

    

    

<article id="prenext-posts" class="prev-next articles">
    <div class="row article-row">
        
        <div class="article col s12 m6" data-aos="fade-up">
            <div class="article-badge left-badge text-color">
                <i class="fas fa-chevron-left"></i>&nbsp;Previous</div>
            <div class="card">
                <a href="/2022/02/03/customize-your-burndown-chart/">
                    <div class="card-image">
                        
                        
                        <img src="/medias/featureimages/9.jpg" class="responsive-img" alt="Customize your burndown chart">
                        
                        <span class="card-title">Customize your burndown chart</span>
                    </div>
                </a>
                <div class="card-content article-content">
                    <div class="summary block-with-text">
                        
                            
                        
                    </div>
                    <div class="publish-info">
                        <span class="publish-date">
                            <i class="far fa-clock fa-fw icon-date"></i>2022-02-03
                        </span>
                        <span class="publish-author">
                            
                            <i class="fas fa-bookmark fa-fw icon-category"></i>
                            
                            <a href="/categories/python-report/" class="post-category">
                                    python report
                                </a>
                            
                            <a href="/categories/python-report/python-pyecharts/" class="post-category">
                                    python pyecharts
                                </a>
                            
                            
                        </span>
                    </div>
                </div>
                
                <div class="card-action article-tags">
                    
                    <a href="/tags/python-pyecharts/">
                        <span class="chip bg-color">python pyecharts</span>
                    </a>
                    
                    <a href="/tags/python-report/">
                        <span class="chip bg-color">python report</span>
                    </a>
                    
                </div>
                
            </div>
        </div>
        
        
        <div class="article col s12 m6" data-aos="fade-up">
            <div class="article-badge right-badge text-color">
                Next&nbsp;<i class="fas fa-chevron-right"></i>
            </div>
            <div class="card">
                <a href="/2021/12/28/some-useful-consolidations-between-file-path-and-time-difference/">
                    <div class="card-image">
                        
                        
                        <img src="/medias/featureimages/30.jpg" class="responsive-img" alt="Some Useful Consolidations between File Path and Time Difference">
                        
                        <span class="card-title">Some Useful Consolidations between File Path and Time Difference</span>
                    </div>
                </a>
                <div class="card-content article-content">
                    <div class="summary block-with-text">
                        
                            
                        
                    </div>
                    <div class="publish-info">
                            <span class="publish-date">
                                <i class="far fa-clock fa-fw icon-date"></i>2021-12-28
                            </span>
                        <span class="publish-author">
                            
                            <i class="fas fa-user fa-fw"></i>
                            Alan_Yuan
                            
                        </span>
                    </div>
                </div>
                
                <div class="card-action article-tags">
                    
                    <a href="/tags/Python/">
                        <span class="chip bg-color">Python</span>
                    </a>
                    
                    <a href="/tags/Python-Common-operations/">
                        <span class="chip bg-color">Python Common operations</span>
                    </a>
                    
                </div>
                
            </div>
        </div>
        
    </div>
</article>

</div>


<script>
    $('#articleContent').on('copy', function (e) {
        // IE8 or earlier browser is 'undefined'
        if (typeof window.getSelection === 'undefined') return;

        var selection = window.getSelection();
        // if the selection is short let's not annoy our users.
        if (('' + selection).length < Number.parseInt('120')) {
            return;
        }

        // create a div outside of the visible area and fill it with the selected text.
        var bodyElement = document.getElementsByTagName('body')[0];
        var newdiv = document.createElement('div');
        newdiv.style.position = 'absolute';
        newdiv.style.left = '-99999px';
        bodyElement.appendChild(newdiv);
        newdiv.appendChild(selection.getRangeAt(0).cloneContents());

        // we need a <pre> tag workaround.
        // otherwise the text inside "pre" loses all the line breaks!
        if (selection.getRangeAt(0).commonAncestorContainer.nodeName === 'PRE') {
            newdiv.innerHTML = "<pre>" + newdiv.innerHTML + "</pre>";
        }

        var url = document.location.href;
        newdiv.innerHTML += '<br />'
            + 'From: Alan.Yuan<br />'
            + 'Author: Alan_Yuan<br />'
            + 'Link: <a href="' + url + '">' + url + '</a><br />'
            + '本文章著作权归作者所有，任何形式的转载都请注明出处。';

        selection.selectAllChildren(newdiv);
        window.setTimeout(function () {bodyElement.removeChild(newdiv);}, 200);
    });
</script>


<!-- 代码块功能依赖 -->
<script type="text/javascript" src="/libs/codeBlock/codeBlockFuction.js"></script>

<!-- 代码语言 -->

<script type="text/javascript" src="/libs/codeBlock/codeLang.js"></script>


<!-- 代码块复制 -->

<script type="text/javascript" src="/libs/codeBlock/codeCopy.js"></script>


<!-- 代码块收缩 -->

<script type="text/javascript" src="/libs/codeBlock/codeShrink.js"></script>


    </div>
    <div id="toc-aside" class="expanded col l3 hide-on-med-and-down">
        <div class="toc-widget card" style="background-color: white;">
            <div class="toc-title"><i class="far fa-list-alt"></i>&nbsp;&nbsp;TOC</div>
            <div id="toc-content"></div>
        </div>
    </div>
</div>

<!-- TOC 悬浮按钮. -->

<div id="floating-toc-btn" class="hide-on-med-and-down">
    <a class="btn-floating btn-large bg-color">
        <i class="fas fa-list-ul"></i>
    </a>
</div>


<script src="/libs/tocbot/tocbot.min.js"></script>
<script>
    $(function () {
        tocbot.init({
            tocSelector: '#toc-content',
            contentSelector: '#articleContent',
            headingsOffset: -($(window).height() * 0.4 - 45),
            collapseDepth: Number('0'),
            headingSelector: 'h2, h3, h4'
        });

        // modify the toc link href to support Chinese.
        let i = 0;
        let tocHeading = 'toc-heading-';
        $('#toc-content a').each(function () {
            $(this).attr('href', '#' + tocHeading + (++i));
        });

        // modify the heading title id to support Chinese.
        i = 0;
        $('#articleContent').children('h2, h3, h4').each(function () {
            $(this).attr('id', tocHeading + (++i));
        });

        // Set scroll toc fixed.
        let tocHeight = parseInt($(window).height() * 0.4 - 64);
        let $tocWidget = $('.toc-widget');
        $(window).scroll(function () {
            let scroll = $(window).scrollTop();
            /* add post toc fixed. */
            if (scroll > tocHeight) {
                $tocWidget.addClass('toc-fixed');
            } else {
                $tocWidget.removeClass('toc-fixed');
            }
        });

        
        /* 修复文章卡片 div 的宽度. */
        let fixPostCardWidth = function (srcId, targetId) {
            let srcDiv = $('#' + srcId);
            if (srcDiv.length === 0) {
                return;
            }

            let w = srcDiv.width();
            if (w >= 450) {
                w = w + 21;
            } else if (w >= 350 && w < 450) {
                w = w + 18;
            } else if (w >= 300 && w < 350) {
                w = w + 16;
            } else {
                w = w + 14;
            }
            $('#' + targetId).width(w);
        };

        // 切换TOC目录展开收缩的相关操作.
        const expandedClass = 'expanded';
        let $tocAside = $('#toc-aside');
        let $mainContent = $('#main-content');
        $('#floating-toc-btn .btn-floating').click(function () {
            if ($tocAside.hasClass(expandedClass)) {
                $tocAside.removeClass(expandedClass).hide();
                $mainContent.removeClass('l9');
            } else {
                $tocAside.addClass(expandedClass).show();
                $mainContent.addClass('l9');
            }
            fixPostCardWidth('artDetail', 'prenext-posts');
        });
        
    });
</script>

    

</main>




    <footer class="page-footer bg-color">
    

    <div class="container row center-align"
         style="margin-bottom: 0px !important;">
        <div class="col s12 m12 24 copy-right">
            Copyright&nbsp;&copy;
            
                <span id="year">2015-2022</span>
            
            <!--<span id="year">2015</span>-->
            |&nbsp;Powered by&nbsp;<a href="/about" target="_blank">Alan_Yuan</a>

            
            
            
                
            
            
                <span id="busuanzi_container_site_pv">
                &nbsp;|&nbsp;<i class="far fa-eye"></i>&nbsp;Total visits:&nbsp;
                    <span id="busuanzi_value_site_pv" class="white-color"></span>
            </span>
            
            
                <span id="busuanzi_container_site_uv">
                &nbsp;|&nbsp;<i class="fas fa-users"></i>&nbsp;Total visitors:&nbsp;
                    <span id="busuanzi_value_site_uv" class="white-color"></span>
            </span>
            
            <br>

            <!-- 运行天数提醒. -->
            
            <br>
            
        </div>
        <div class="col s12 m4 l4 social-link social-statis"><!-- 

    <a href="https://github.com/" class="tooltipped" target="_blank" data-tooltip="访问我的GitHub" data-position="top" data-delay="50">
        <i class="fab fa-github"></i>
    </a>

-->

<!--

    <a href="mailto:1094181625@qq.com" class="tooltipped" target="_blank" data-tooltip="邮件联系我" data-position="top" data-delay="50">
        <i class="fas fa-envelope-open"></i>
    </a>








    <a href="tencent://AddContact/?fromId=50&fromSubId=1&subcmd=all&uin=1094181625" class="tooltipped" target="_blank" data-tooltip="QQ联系我: 1094181625" data-position="top" data-delay="50">
        <i class="fab fa-qq"></i>
    </a>







    <a href="/atom.xml" class="tooltipped" target="_blank" data-tooltip="RSS 订阅" data-position="top" data-delay="50">
        <i class="fas fa-rss"></i>
    </a>

-->
</div>
    </div>
</footer>

<div class="progress-bar"></div>


    <!-- 搜索遮罩框 -->
<div id="searchModal" class="modal">
    <div class="modal-content">
        <div class="search-header">
            <span class="title"><i class="fas fa-search"></i>&nbsp;&nbsp;Search</span>
            <input type="search" id="searchInput" name="s" placeholder="Please enter a search keyword"
                   class="search-input">
        </div>
        <div id="searchResult"></div>
    </div>
</div>

<script type="text/javascript">
$(function () {
    var searchFunc = function (path, search_id, content_id) {
        'use strict';
        $.ajax({
            url: path,
            dataType: "xml",
            success: function (xmlResponse) {
                // get the contents from search data
                var datas = $("entry", xmlResponse).map(function () {
                    return {
                        title: $("title", this).text(),
                        content: $("content", this).text(),
                        url: $("url", this).text()
                    };
                }).get();
                var $input = document.getElementById(search_id);
                var $resultContent = document.getElementById(content_id);
                $input.addEventListener('input', function () {
                    var str = '<ul class=\"search-result-list\">';
                    var keywords = this.value.trim().toLowerCase().split(/[\s\-]+/);
                    $resultContent.innerHTML = "";
                    if (this.value.trim().length <= 0) {
                        return;
                    }
                    // perform local searching
                    datas.forEach(function (data) {
                        var isMatch = true;
                        var data_title = data.title.trim().toLowerCase();
                        var data_content = data.content.trim().replace(/<[^>]+>/g, "").toLowerCase();
                        var data_url = data.url;
                        data_url = data_url.indexOf('/') === 0 ? data.url : '/' + data_url;
                        var index_title = -1;
                        var index_content = -1;
                        var first_occur = -1;
                        // only match artiles with not empty titles and contents
                        if (data_title !== '' && data_content !== '') {
                            keywords.forEach(function (keyword, i) {
                                index_title = data_title.indexOf(keyword);
                                index_content = data_content.indexOf(keyword);
                                if (index_title < 0 && index_content < 0) {
                                    isMatch = false;
                                } else {
                                    if (index_content < 0) {
                                        index_content = 0;
                                    }
                                    if (i === 0) {
                                        first_occur = index_content;
                                    }
                                }
                            });
                        }
                        // show search results
                        if (isMatch) {
                            str += "<li><a href='" + data_url + "' class='search-result-title'>" + data_title + "</a>";
                            var content = data.content.trim().replace(/<[^>]+>/g, "");
                            if (first_occur >= 0) {
                                // cut out 100 characters
                                var start = first_occur - 20;
                                var end = first_occur + 80;
                                if (start < 0) {
                                    start = 0;
                                }
                                if (start === 0) {
                                    end = 100;
                                }
                                if (end > content.length) {
                                    end = content.length;
                                }
                                var match_content = content.substr(start, end);
                                // highlight all keywords
                                keywords.forEach(function (keyword) {
                                    var regS = new RegExp(keyword, "gi");
                                    match_content = match_content.replace(regS, "<em class=\"search-keyword\">" + keyword + "</em>");
                                });

                                str += "<p class=\"search-result\">" + match_content + "...</p>"
                            }
                            str += "</li>";
                        }
                    });
                    str += "</ul>";
                    $resultContent.innerHTML = str;
                });
            }
        });
    };

    searchFunc('/search.xml', 'searchInput', 'searchResult');
});
</script>

    <!-- 回到顶部按钮 -->
<div id="backTop" class="top-scroll">
    <a class="btn-floating btn-large waves-effect waves-light" href="#!">
        <i class="fas fa-arrow-up"></i>
    </a>
</div>


    <script src="/libs/materialize/materialize.min.js"></script>
    <script src="/libs/masonry/masonry.pkgd.min.js"></script>
    <script src="/libs/aos/aos.js"></script>
    <script src="/libs/scrollprogress/scrollProgress.min.js"></script>
    <script src="/libs/lightGallery/js/lightgallery-all.min.js"></script>
    <script src="/js/matery.js"></script>

    <!-- Baidu Analytics -->

<script>
    var _hmt = _hmt || [];
    (function () {
        var hm = document.createElement("script");
        hm.src = "https://hm.baidu.com/hm.js?";
        var s = document.getElementsByTagName("script")[0];
        s.parentNode.insertBefore(hm, s);
    })();
</script>

    <!-- Baidu Push -->

<script>
    (function () {
        var bp = document.createElement('script');
        var curProtocol = window.location.protocol.split(':')[0];
        if (curProtocol === 'https') {
            bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
        } else {
            bp.src = 'http://push.zhanzhang.baidu.com/push.js';
        }
        var s = document.getElementsByTagName("script")[0];
        s.parentNode.insertBefore(bp, s);
    })();
</script>

    
    
    <script async src="/libs/others/busuanzi.pure.mini.js"></script>
    

    

    

    <!--腾讯兔小巢-->
    
    

    

    

    
    <script src="/libs/instantpage/instantpage.js" type="module"></script>
    

</body>

</html>
